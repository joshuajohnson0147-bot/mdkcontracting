<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Human Verification | CAPTCHA</title>
    <meta name="description" content="Interactive human verification system">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: linear-gradient(180deg, hsl(220, 25%, 97%) 0%, hsl(220, 20%, 92%) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        .captcha-card {
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 16px -4px rgba(0, 0, 0, 0.12);
            padding: 1.5rem;
            width: 100%;
            max-width: 28rem;
        }

        .header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .header svg {
            width: 1.5rem;
            height: 1.5rem;
            color: hsl(217, 91%, 60%);
        }

        .header h2 {
            font-size: 1.25rem;
            font-weight: 700;
            color: hsl(220, 15%, 15%);
        }

        .challenge-title {
            text-align: center;
            margin-bottom: 0.5rem;
        }

        .challenge-title h3 {
            font-size: 1.125rem;
            font-weight: 600;
            color: hsl(220, 15%, 15%);
        }

        .challenge-description {
            text-align: center;
            font-size: 0.875rem;
            color: hsl(220, 10%, 45%);
            margin-bottom: 1.5rem;
        }

        .slider-container {
            position: relative;
            margin-bottom: 1.5rem;
        }

        .slider-track {
            height: 6rem;
            background: hsl(220, 15%, 95%);
            border-radius: 0.5rem;
            position: relative;
            overflow: hidden;
            border: 1px solid hsl(220, 15%, 88%);
        }

        .slider-target {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 4px;
            background: hsl(217, 91%, 60%);
            transition: all 0.3s;
        }

        .slider-target::before {
            content: '';
            position: absolute;
            top: 50%;
            left: -8px;
            transform: translateY(-50%);
            width: 16px;
            height: 32px;
            background: hsl(217, 91%, 60%);
            border-radius: 2px;
        }

        .slider-fill {
            position: absolute;
            top: 0;
            bottom: 0;
            left: 0;
            background: linear-gradient(135deg, hsl(217, 91%, 60%) 0%, hsl(217, 91%, 70%) 100%);
            transition: all 0.15s;
        }

        .slider-fill.verified {
            background: linear-gradient(135deg, hsl(142, 76%, 36%) 0%, hsl(142, 76%, 46%) 100%);
        }

        .slider-input {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        .success-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: hsl(142, 76%, 36%);
            color: white;
            border-radius: 50%;
            padding: 0.75rem;
            animation: zoomIn 0.3s;
        }

        .pattern-grid, .image-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .grid-cell {
            aspect-ratio: 1;
            border-radius: 0.5rem;
            border: 2px solid hsl(220, 15%, 88%);
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
        }

        .grid-cell:hover:not(:disabled) {
            border-color: hsl(217, 91%, 60%);
        }

        .grid-cell.selected {
            background: linear-gradient(135deg, hsl(217, 91%, 60%) 0%, hsl(217, 91%, 70%) 100%);
            border-color: hsl(217, 91%, 60%);
        }

        .grid-cell.verified {
            background: linear-gradient(135deg, hsl(142, 76%, 36%) 0%, hsl(142, 76%, 46%) 100%);
            border-color: hsl(142, 76%, 36%);
        }

        .grid-cell.failed {
            background: hsl(0, 84%, 60%);
            border-color: hsl(0, 84%, 60%);
            animation: shake 0.5s;
        }

        .grid-cell.pulse {
            animation: pulse 1s ease-in-out;
        }

        .grid-cell .order {
            color: white;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .status-text {
            font-size: 0.875rem;
            color: hsl(220, 10%, 45%);
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid hsl(220, 15%, 88%);
            background: white;
            color: hsl(220, 15%, 15%);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn:hover:not(:disabled) {
            background: hsl(220, 15%, 95%);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-primary {
            background: linear-gradient(135deg, hsl(217, 91%, 60%) 0%, hsl(217, 91%, 70%) 100%);
            color: white;
            border: none;
        }

        .btn-primary:hover:not(:disabled) {
            opacity: 0.9;
        }

        .type-selector {
            border-top: 1px solid hsl(220, 15%, 88%);
            padding-top: 1rem;
        }

        .type-selector p {
            text-align: center;
            font-size: 0.75rem;
            color: hsl(220, 10%, 45%);
            margin-bottom: 0.75rem;
        }

        .type-buttons {
            display: flex;
            gap: 0.5rem;
            justify-content: center;
        }

        .success-screen {
            text-align: center;
            padding: 2rem 0;
        }

        .success-screen .icon-large {
            display: inline-flex;
            background: linear-gradient(135deg, hsl(142, 76%, 36%) 0%, hsl(142, 76%, 46%) 100%);
            color: white;
            padding: 1.5rem;
            border-radius: 50%;
            margin-bottom: 1.5rem;
            animation: zoomIn 0.5s;
        }

        .success-screen h3 {
            font-size: 1.5rem;
            font-weight: 700;
            color: hsl(220, 15%, 15%);
            margin-bottom: 0.5rem;
        }

        .success-screen p {
            color: hsl(220, 10%, 45%);
            margin-bottom: 0.5rem;
        }

        .hidden {
            display: none;
        }

        @keyframes zoomIn {
            from {
                transform: translate(-50%, -50%) scale(0);
            }
            to {
                transform: translate(-50%, -50%) scale(1);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }
    </style>
</head>
<body>
    <div class="captcha-card">
        <!-- Success Screen -->
        <div id="successScreen" class="success-screen hidden">
            <div class="icon-large">
                <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"></polyline>
                </svg>
            </div>
            <h3>Verified!</h3>
            <p id="successMessage">You've successfully completed the challenge</p>
            <p style="font-size: 0.875rem; margin-top: 0.5rem;">Redirecting you now...</p>
        </div>

        <!-- Challenge Screen -->
        <div id="challengeScreen">
            <div class="header">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
                <h2>Human Verification</h2>
            </div>

            <!-- Slider Challenge -->
            <div id="sliderChallenge" class="challenge-content">
                <div class="challenge-title">
                    <h3>Slide to Verify</h3>
                </div>
                <div class="challenge-description">
                    Align the slider with the target position
                </div>
                <div class="slider-container">
                    <div class="slider-track">
                        <div id="sliderTarget" class="slider-target"></div>
                        <div id="sliderFill" class="slider-fill"></div>
                        <input type="range" id="sliderInput" class="slider-input" min="0" max="100" value="0">
                    </div>
                </div>
                <div class="controls">
                    <span id="sliderStatus" class="status-text">Drag the slider</span>
                    <button class="btn" onclick="resetSlider()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                        </svg>
                        Reset
                    </button>
                </div>
            </div>

            <!-- Pattern Challenge -->
            <div id="patternChallenge" class="challenge-content hidden">
                <div class="challenge-title">
                    <h3>Pattern Recognition</h3>
                </div>
                <div class="challenge-description">
                    Click the cells in the order they blink
                </div>
                <div class="pattern-grid" id="patternGrid"></div>
                <div class="controls">
                    <span id="patternStatus" class="status-text">Watch the pattern</span>
                    <button class="btn" onclick="resetPattern()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                        </svg>
                        Reset
                    </button>
                </div>
            </div>

            <!-- Image Challenge -->
            <div id="imageChallenge" class="challenge-content hidden">
                <div class="challenge-title">
                    <h3>Image Selection</h3>
                </div>
                <div class="challenge-description" id="imageDescription">
                    Select all squares with the target
                </div>
                <div class="image-grid" id="imageGrid"></div>
                <div class="controls">
                    <span id="imageStatus" class="status-text">Select matching images</span>
                    <button class="btn" onclick="resetImage()">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.2"></path>
                        </svg>
                        Reset
                    </button>
                </div>
            </div>

            <!-- Type Selector -->
            <div class="type-selector">
                <p>Try different verification methods:</p>
                <div class="type-buttons">
                    <button class="btn btn-primary" onclick="switchChallenge('slider')">Slider</button>
                    <button class="btn" onclick="switchChallenge('pattern')">Pattern</button>
                    <button class="btn" onclick="switchChallenge('image')">Image</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const REDIRECT_URL = "https://assets-usa.mkt.dynamics.com/a2e003b6-c7b5-f011-95c5-6045bd03cf07/digitalassets/standaloneforms/e422a221-fdbc-f011-bbd3-6045bd096200";
        let currentChallenge = 'slider';
        let isVerified = false;

        // Slider Challenge
        let sliderTarget = 70;

        function initSlider() {
            sliderTarget = Math.floor(Math.random() * 30) + 65;
            document.getElementById('sliderTarget').style.left = sliderTarget + '%';
            document.getElementById('sliderInput').value = 0;
            document.getElementById('sliderFill').style.width = '0%';
            document.getElementById('sliderFill').classList.remove('verified');
            document.getElementById('sliderStatus').textContent = 'Drag the slider';
            
            const existingIcon = document.querySelector('.success-icon');
            if (existingIcon) existingIcon.remove();
        }

        document.getElementById('sliderInput').addEventListener('input', function(e) {
            const value = parseInt(e.target.value);
            document.getElementById('sliderFill').style.width = value + '%';
            
            if (Math.abs(value - sliderTarget) < 3 && !isVerified) {
                verifySuccess('slider');
                document.getElementById('sliderFill').classList.add('verified');
                document.getElementById('sliderStatus').textContent = 'Verified!';
                document.getElementById('sliderInput').disabled = true;
                
                const icon = document.createElement('div');
                icon.className = 'success-icon';
                icon.innerHTML = '<svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"></polyline></svg>';
                document.querySelector('.slider-track').appendChild(icon);
            }
        });

        function resetSlider() {
            isVerified = false;
            document.getElementById('sliderInput').disabled = false;
            initSlider();
        }

        // Pattern Challenge
        let pattern = [];
        let selectedCells = [];
        let patternShowing = false;

        function initPattern() {
            pattern = [];
            selectedCells = [];
            patternShowing = false;
            
            while (pattern.length < 3) {
                const random = Math.floor(Math.random() * 9);
                if (!pattern.includes(random)) pattern.push(random);
            }
            
            const grid = document.getElementById('patternGrid');
            grid.innerHTML = '';
            
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('button');
                cell.className = 'grid-cell';
                cell.dataset.index = i;
                cell.onclick = () => handlePatternClick(i);
                grid.appendChild(cell);
            }
            
            document.getElementById('patternStatus').textContent = 'Watch the pattern';
            showPattern();
        }

        function showPattern() {
            patternShowing = true;
            pattern.forEach((index, order) => {
                setTimeout(() => {
                    const cells = document.querySelectorAll('#patternGrid .grid-cell');
                    cells[index].classList.add('pulse');
                    setTimeout(() => cells[index].classList.remove('pulse'), 500);
                    
                    if (order === pattern.length - 1) {
                        setTimeout(() => {
                            patternShowing = false;
                            document.getElementById('patternStatus').textContent = 'Click the pattern';
                        }, 500);
                    }
                }, order * 600);
            });
        }

        function handlePatternClick(index) {
            if (isVerified || patternShowing || selectedCells.includes(index)) return;
            
            selectedCells.push(index);
            const cells = document.querySelectorAll('#patternGrid .grid-cell');
            cells[index].classList.add('selected');
            cells[index].innerHTML = `<span class="order">${selectedCells.length}</span>`;
            
            document.getElementById('patternStatus').textContent = `Selected: ${selectedCells.length}/${pattern.length}`;
            
            if (selectedCells.length === pattern.length) {
                const isCorrect = pattern.every((val, i) => val === selectedCells[i]);
                if (isCorrect) {
                    cells.forEach((cell, i) => {
                        if (selectedCells.includes(i)) cell.classList.add('verified');
                    });
                    document.getElementById('patternStatus').textContent = 'Verified!';
                    verifySuccess('pattern');
                } else {
                    cells.forEach((cell, i) => {
                        if (selectedCells.includes(i)) cell.classList.add('failed');
                    });
                    document.getElementById('patternStatus').textContent = 'Try again!';
                    setTimeout(() => {
                        selectedCells = [];
                        cells.forEach(cell => {
                            cell.classList.remove('selected', 'failed');
                            cell.innerHTML = '';
                        });
                        document.getElementById('patternStatus').textContent = 'Click the pattern';
                    }, 1500);
                }
            }
        }

        function resetPattern() {
            isVerified = false;
            initPattern();
        }

        // Image Challenge
        const EMOJIS = [
            { emoji: "üöó", name: "car" },
            { emoji: "üö≤", name: "bicycle" },
            { emoji: "üè†", name: "house" },
            { emoji: "üå≥", name: "tree" },
            { emoji: "üå∏", name: "flower" },
            { emoji: "üê∂", name: "dog" },
            { emoji: "üê±", name: "cat" },
            { emoji: "üé®", name: "art" },
            { emoji: "‚öΩ", name: "ball" }
        ];
        let targetEmoji = null;
        let imageSelected = [];
        let correctCount = 0;

        function initImage() {
            imageSelected = [];
            targetEmoji = EMOJIS[Math.floor(Math.random() * EMOJIS.length)];
            correctCount = Math.floor(Math.random() * 2) + 2;
            
            const grid = [];
            for (let i = 0; i < correctCount; i++) grid.push(targetEmoji);
            
            while (grid.length < 9) {
                const random = EMOJIS[Math.floor(Math.random() * EMOJIS.length)];
                if (random.name !== targetEmoji.name) grid.push(random);
            }
            
            for (let i = grid.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [grid[i], grid[j]] = [grid[j], grid[i]];
            }
            
            document.getElementById('imageDescription').innerHTML = 
                `Select all squares with <strong>${targetEmoji.emoji} ${targetEmoji.name}</strong>`;
            
            const gridEl = document.getElementById('imageGrid');
            gridEl.innerHTML = '';
            
            grid.forEach((item, i) => {
                const cell = document.createElement('button');
                cell.className = 'grid-cell';
                cell.textContent = item.emoji;
                cell.dataset.index = i;
                cell.dataset.name = item.name;
                cell.onclick = () => handleImageClick(i, item.name);
                gridEl.appendChild(cell);
            });
            
            document.getElementById('imageStatus').textContent = `Selected: 0/${correctCount}`;
        }

        function handleImageClick(index, name) {
            if (isVerified) return;
            
            const cells = document.querySelectorAll('#imageGrid .grid-cell');
            const cell = cells[index];
            
            if (imageSelected.includes(index)) {
                imageSelected = imageSelected.filter(i => i !== index);
                cell.classList.remove('selected');
            } else {
                imageSelected.push(index);
                cell.classList.add('selected');
            }
            
            document.getElementById('imageStatus').textContent = `Selected: ${imageSelected.length}/${correctCount}`;
            
            const correctIndices = Array.from(cells)
                .map((c, i) => c.dataset.name === targetEmoji.name ? i : -1)
                .filter(i => i !== -1);
            
            if (imageSelected.length === correctIndices.length && 
                correctIndices.every(i => imageSelected.includes(i))) {
                cells.forEach((c, i) => {
                    if (imageSelected.includes(i)) c.classList.add('verified');
                });
                document.getElementById('imageStatus').textContent = 'Verified!';
                verifySuccess('image');
            }
        }

        function resetImage() {
            isVerified = false;
            initImage();
        }

        // Challenge switching
        function switchChallenge(type) {
            if (isVerified) return;
            
            currentChallenge = type;
            document.querySelectorAll('.challenge-content').forEach(el => el.classList.add('hidden'));
            document.getElementById(type + 'Challenge').classList.remove('hidden');
            
            document.querySelectorAll('.type-buttons .btn').forEach(btn => {
                btn.classList.remove('btn-primary');
            });
            event.target.classList.add('btn-primary');
            
            if (type === 'slider') initSlider();
            else if (type === 'pattern') initPattern();
            else if (type === 'image') initImage();
        }

        // Success handling
        function verifySuccess(type) {
            isVerified = true;
            
            setTimeout(() => {
                document.getElementById('challengeScreen').classList.add('hidden');
                document.getElementById('successScreen').classList.remove('hidden');
                document.getElementById('successMessage').textContent = 
                    `You've successfully completed the ${type} challenge`;
                
                setTimeout(() => {
                    window.location.href = REDIRECT_URL;
                }, 2000);
            }, 500);
        }

        // Initialize
        initSlider();
    </script>
</body>
</html>
